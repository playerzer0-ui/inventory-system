```json
{
    "0": {
        "storageCode": "APA",
        "month": "08",
        "year": "2024"
    },
    "RR-100-A": {
        "productCode": "RR-100-A",
        "productName": "Reguler Mono 100 Acetatow",
        "initial_balance": {
            "totalQty": 0,
            "price_per_qty": 0,
            "totalPrice": 0
        },
        "in": {
            "purchase": {
                "totalQty": "3000",
                "price_per_qty": "485000",
                "totalPrice": 1455000000
            },
            "repackIn": {
                "totalQty": "1000",
                "price_per_qty": 487500,
                "totalPrice": 487500000
            },
            "movingIn": {
                "totalQty": 0,
                "price_per_qty": 0,
                "totalPrice": 0
            },
            "totalIn": {
                "totalQty": 4000,
                "price_per_qty": 485625,
                "totalPrice": 1942500000
            }
        },
        "out": {
            "sales": {
                "totalQty": "3000",
                "price_per_qty": 485625,
                "totalPrice": 1456875000
            },
            "repackOut": {
                "totalQty": 0,
                "price_per_qty": 0,
                "totalPrice": 0
            },
            "movingOut": {
                "totalQty": 0,
                "price_per_qty": 0,
                "totalPrice": 0
            },
            "totalOut": {
                "totalQty": 3000,
                "price_per_qty": 485625,
                "totalPrice": 1456875000
            }
        },
        "ready_to_sell_items": {
            "totalQty": 4000,
            "price_per_qty": 485625,
            "totalPrice": 1942500000
        },
        "final_balance": {
            "totalQty": 1000,
            "price_per_qty": 485625,
            "totalPrice": 485625000
        }
    },
    "MM-120-A": {
        "productCode": "MM-120-A",
        "productName": "Mild Mono 120 Acetatow",
        "initial_balance": {
            "totalQty": 0,
            "price_per_qty": 0,
            "totalPrice": 0
        },
        "penerimaan": {
            "pembelian": {
                "totalQty": "5000",
                "price_per_qty": "600000",
                "totalPrice": 3000000000
            },
            "repackIn": {
                "totalQty": 0,
                "price_per_qty": 0,
                "totalPrice": 0
            },
            "movingIn": {
                "totalQty": 0,
                "price_per_qty": 0,
                "totalPrice": 0
            },
            "totalIn": {
                "totalQty": 5000,
                "price_per_qty": 600000,
                "totalPrice": 3000000000
            }
        },
        "out": {
            "sales": {
                "totalQty": "3000",
                "price_per_qty": 600000,
                "totalPrice": 1800000000
            },
            "repackOut": {
                "totalQty": 0,
                "price_per_qty": 0,
                "totalPrice": 0
            },
            "movingOut": {
                "totalQty": "2000",
                "price_per_qty": 600000,
                "totalPrice": 1200000000
            },
            "totalOut": {
                "totalQty": 5000,
                "price_per_qty": 600000,
                "totalPrice": 3000000000
            }
        },
        "ready_to_sell_items": {
            "totalQty": 5000,
            "price_per_qty": 600000,
            "totalPrice": 3000000000
        },
        "final_balance": {
            "totalQty": 0,
            "price_per_qty": 0,
            "totalPrice": 0
        }
    },
    "MM-100-A": {
        "productCode": "MM-100-A",
        "productName": "Mild Mono 100 Acetatow",
        "initial_balance": {
            "totalQty": 0,
            "price_per_qty": 0,
            "totalPrice": 0
        },
        "penerimaan": {
            "pembelian": {
                "totalQty": "6000",
                "price_per_qty": "582500",
                "totalPrice": 3495000000
            },
            "repackIn": {
                "totalQty": 0,
                "price_per_qty": 0,
                "totalPrice": 0
            },
            "movingIn": {
                "totalQty": 0,
                "price_per_qty": 0,
                "totalPrice": 0
            },
            "totalIn": {
                "totalQty": 6000,
                "price_per_qty": 582500,
                "totalPrice": 3495000000
            }
        },
        "out": {
            "sales": {
                "totalQty": "6000",
                "price_per_qty": 582500,
                "totalPrice": 3495000000
            },
            "repackOut": {
                "totalQty": 0,
                "price_per_qty": 0,
                "totalPrice": 0
            },
            "movingOut": {
                "totalQty": 0,
                "price_per_qty": 0,
                "totalPrice": 0
            },
            "totalOut": {
                "totalQty": 6000,
                "price_per_qty": 582500,
                "totalPrice": 3495000000
            }
        },
        "ready_to_sell_items": {
            "totalQty": 6000,
            "price_per_qty": 582500,
            "totalPrice": 3495000000
        },
        "final_balance": {
            "totalQty": 0,
            "price_per_qty": 0,
            "totalPrice": 0
        }
    },
    "RR-120-A": {
        "productCode": "RR-120-A",
        "productName": "Reguler Mono 120 Acetatow",
        "initial_balance": {
            "totalQty": 0,
            "price_per_qty": 0,
            "totalPrice": 0
        },
        "penerimaan": {
            "pembelian": {
                "totalQty": "8000",
                "price_per_qty": "487500",
                "totalPrice": 3900000000
            },
            "repackIn": {
                "totalQty": 0,
                "price_per_qty": 0,
                "totalPrice": 0
            },
            "movingIn": {
                "totalQty": 0,
                "price_per_qty": 0,
                "totalPrice": 0
            },
            "totalIn": {
                "totalQty": 8000,
                "price_per_qty": 487500,
                "totalPrice": 3900000000
            }
        },
        "out": {
            "sales": {
                "totalQty": "5500",
                "price_per_qty": 487500,
                "totalPrice": 2681250000
            },
            "repackOut": {
                "totalQty": "1000",
                "price_per_qty": 487500,
                "totalPrice": 487500000
            },
            "movingOut": {
                "totalQty": "1500",
                "price_per_qty": 487500,
                "totalPrice": 731250000
            },
            "totalOut": {
                "totalQty": 8000,
                "price_per_qty": 487500,
                "totalPrice": 3900000000
            }
        },
        "ready_to_sell_items": {
            "totalQty": 8000,
            "price_per_qty": 487500,
            "totalPrice": 3900000000
        },
        "final_balance": {
            "totalQty": 0,
            "price_per_qty": 0,
            "totalPrice": 0
        }
    }
}
```
I need help with accquiring data and formatting it to this json, 

SELECT 
            p.productCode, 
            p.productName,
            o.storageCode, 
            MONTH(i.invoice_date) AS saldoMonth, 
            YEAR(i.invoice_date) AS saldoYear, 
            SUM(op.qty) AS totalQty, 
            ROUND(SUM(op.price_per_UOM * op.qty) / SUM(op.qty)) AS avgPrice,
            op.product_status
        FROM
            products p
        JOIN 
            order_products op ON p.productCode = op.productCode
        JOIN 
            orders o ON op.nomor_surat_jalan = o.nomor_surat_jalan
        JOIN 
            invoices i ON o.nomor_surat_jalan = i.nomor_surat_jalan
        WHERE 
            o.storageCode = 'APA'
            AND MONTH(i.invoice_date) = 8
            AND YEAR(i.invoice_date) = 2024
            AND op.product_status != "out_tax" AND op.product_status NOT LIKE "%repack%"
        GROUP BY 
            p.productCode, 
            p.productName,
            o.storageCode, 
            saldoMonth, 
            saldoYear,
            op.product_status
    
    UNION ALL
    
        SELECT 
            p.productCode, 
            p.productName,
            r.storageCode, 
            MONTH(r.repack_date) AS saldoMonth, 
            YEAR(r.repack_date) AS saldoYear, 
            SUM(op.qty) AS totalQty, 
            ROUND(SUM(op.price_per_UOM * op.qty) / SUM(op.qty)) AS avgPrice,
            op.product_status
        FROM
            products p
        JOIN 
            order_products op ON p.productCode = op.productCode
        JOIN 
            repacks r ON op.repack_no_repack = r.no_repack
        WHERE
            r.storageCode = 'APA'
            AND MONTH(r.repack_date) = 8
            AND YEAR(r.repack_date) = 2024

        GROUP BY 
            p.productCode, 
            p.productName,
            r.storageCode, 
            saldoMonth, 
            saldoYear,
            op.product_status
    
    ORDER BY
        CASE 
            WHEN product_status = "in" THEN 1
            WHEN product_status = "repack_awal" THEN 2
            WHEN product_status = "repack_akhir" THEN 3
            WHEN product_status = 'out' THEN 4
            ELSE 5
        END;









